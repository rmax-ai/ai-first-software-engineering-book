
<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<meta content="Technical book on AI-first software engineering governance and execution" name="description"/>
<meta content="Autonomous Authors" name="author"/>
<link href="../02-harness-engineering/" rel="prev"/>
<link href="../04-memory-systems/" rel="next"/>
<link href="../../../assets/images/favicon.png" rel="icon"/>
<meta content="mkdocs-1.6.1, mkdocs-material-9.7.2" name="generator"/>
<title>03. Autonomous Kernels - AI-First Software Engineering</title>
<link href="../../../assets/stylesheets/main.484c7ddc.min.css" rel="stylesheet"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/>
<style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
<script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
</head>
<body dir="ltr">
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#chapter-03-autonomous-kernels">
          Skip to content
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header md-header--shadow" data-md-component="header">
<nav aria-label="Header" class="md-header__inner md-grid">
<a aria-label="AI-First Software Engineering" class="md-header__button md-logo" data-md-component="logo" href="../../.." title="AI-First Software Engineering">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"></path></svg>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
            AI-First Software Engineering
          </span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
            
              03. Autonomous Kernels
            
          </span>
</div>
</div>
</div>
<script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
<label class="md-header__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="Search" required="" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg>
</label>
<nav aria-label="Search" class="md-search__options">
<button aria-label="Clear" class="md-search__icon md-icon" tabindex="-1" title="Clear" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg>
</button>
</nav>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="" tabindex="0">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            Initializing search
          </div>
<ol class="md-search-result__list" role="presentation"></ol>
</div>
</div>
</div>
</div>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigation" class="md-nav md-nav--primary" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="AI-First Software Engineering" class="md-nav__button md-logo" data-md-component="logo" href="../../.." title="AI-First Software Engineering">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"></path></svg>
</a>
    AI-First Software Engineering
  </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../..">
<span class="md-ellipsis">
    
  
    Home
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../preface/">
<span class="md-ellipsis">
    
  
    Preface
  

    
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
<span class="md-ellipsis">
    
  
    Chapters
  

    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="true" aria-labelledby="__nav_3_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_3">
<span class="md-nav__icon md-icon"></span>
            
  
    Chapters
  

          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../01-paradigm-shift/">
<span class="md-ellipsis">
    
  
    01. Paradigm Shift
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../02-harness-engineering/">
<span class="md-ellipsis">
    
  
    02. Harness Engineering
  

    
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
<span class="md-ellipsis">
    
  
    03. Autonomous Kernels
  

    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<a class="md-nav__link md-nav__link--active" href="./">
<span class="md-ellipsis">
    
  
    03. Autonomous Kernels
  

    
  </span>
</a>
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#thesis">
<span class="md-ellipsis">
      
        Thesis
      
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#why-this-matters">
<span class="md-ellipsis">
      
        Why This Matters
      
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#system-breakdown">
<span class="md-ellipsis">
      
        System Breakdown
      
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#concrete-example-1">
<span class="md-ellipsis">
      
        Concrete Example 1
      
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#concrete-example-2">
<span class="md-ellipsis">
      
        Concrete Example 2
      
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#trade-offs">
<span class="md-ellipsis">
      
        Trade-offs
      
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#failure-modes">
<span class="md-ellipsis">
      
        Failure Modes
      
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#research-directions">
<span class="md-ellipsis">
      
        Research Directions
      
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../04-memory-systems/">
<span class="md-ellipsis">
    
  
    04. Memory Systems
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../05-evaluation-and-traces/">
<span class="md-ellipsis">
    
  
    05. Evaluation and Traces
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../06-agent-governance/">
<span class="md-ellipsis">
    
  
    06. Agent Governance
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../07-production-ai-infrastructure/">
<span class="md-ellipsis">
    
  
    07. Production AI Infrastructure
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../99-future-directions/">
<span class="md-ellipsis">
    
  
    99. Future Directions
  

    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../glossary/">
<span class="md-ellipsis">
    
  
    Glossary
  

    
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_5" type="checkbox"/>
<label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
<span class="md-ellipsis">
    
  
    Patterns Overview
  

    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_5_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_5">
<span class="md-nav__icon md-icon"></span>
            
  
    Patterns Overview
  

          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../patterns/harness-design-patterns/">
<span class="md-ellipsis">
    
  
    Harness Design
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../patterns/memory-architectures/">
<span class="md-ellipsis">
    
  
    Memory Architectures
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../patterns/minimal-agent-loop/">
<span class="md-ellipsis">
    
  
    Minimal Agent Loop
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../patterns/self-verification-loop/">
<span class="md-ellipsis">
    
  
    Self-Verification Loop
  

    
  </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#thesis">
<span class="md-ellipsis">
      
        Thesis
      
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#why-this-matters">
<span class="md-ellipsis">
      
        Why This Matters
      
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#system-breakdown">
<span class="md-ellipsis">
      
        System Breakdown
      
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#concrete-example-1">
<span class="md-ellipsis">
      
        Concrete Example 1
      
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#concrete-example-2">
<span class="md-ellipsis">
      
        Concrete Example 2
      
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#trade-offs">
<span class="md-ellipsis">
      
        Trade-offs
      
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#failure-modes">
<span class="md-ellipsis">
      
        Failure Modes
      
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#research-directions">
<span class="md-ellipsis">
      
        Research Directions
      
    </span>
</a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<h1 id="chapter-03-autonomous-kernels">Chapter 03 — Autonomous Kernels</h1>
<h2 id="thesis">Thesis</h2>
<p>An autonomous kernel is a minimal, well-specified control loop for bounded work: plan, apply tool actions, verify, and stop. It is designed for short-horizon execution with explicit budgets and explicit exit criteria, so its behavior is inspectable and repeatable. It is not a substitute for long-horizon project management or open-ended exploration.</p>
<p>What this is (and is not):</p>
<ul>
<li>A kernel <strong>executes one bounded objective</strong> and stops; it does not “keep going” to find adjacent work.</li>
<li>A kernel <strong>operates inside a declared safety envelope</strong> (budgets + permissions + evaluation gates); it does not expand scope implicitly. Here, “safety envelope” means the explicit combination of budgets, permissions, and evaluation gates. It bounds what actions are allowed and what evidence is required to declare success.</li>
<li>A kernel <strong>treats verification as mandatory</strong> (or explicitly waived with recorded justification); it does not declare success from intent or plausibility.</li>
</ul>
<p>Definitions:</p>
<ul>
<li><strong>Autonomous kernel</strong>: a control loop with explicit limits and explicit exit criteria; it is not “general autonomy,” long-horizon project management, or open-ended exploration.</li>
<li><strong>Budget</strong>: a hard cap on resources (iterations, elapsed time, tool calls, diff size) that prevents runaway behavior and forces escalation when progress stalls.</li>
<li><strong>Evaluation gate</strong>: a required check whose result must be recorded and must be satisfied (or explicitly waived with justification) before the kernel can declare success.</li>
</ul>
<p>Hypothesis: small, well-governed autonomous kernels (tight loops with explicit budgets and evaluation gates) outperform broad autonomy in stability and debuggability.</p>
<h2 id="why-this-matters">Why This Matters</h2>
<ul>
<li>Most failures in agentic work are operational: runaway loops, untraceable edits, and unverifiable outcomes.</li>
<li>Kernels enable composability: multiple kernels can run with different permissions and evaluation profiles.</li>
<li>“Kernel-first” design makes autonomy a system property, not a prompt trick.</li>
</ul>
<h2 id="system-breakdown">System Breakdown</h2>
<ul>
<li><strong>Kernel loop</strong>: intent → plan → act → verify → record trace → stop/iterate.</li>
<li><strong>Budgets</strong>: max iterations, time, tool calls, diff size.</li>
<li><strong>Permissions</strong>: read/write scopes, protected paths, allowed tools.</li>
<li><strong>Verification</strong>: mandatory checks per action class (e.g., tests for code changes).</li>
<li><strong>Persistence</strong>: ledger entries, trace logs, artifacts.</li>
</ul>
<p>The loop stages are the execution path. Budgets, permissions, and evaluation gates are the controls that constrain what can happen at each stage and what evidence is required to stop.</p>
<p>Treat each loop step as a checkpoint with two requirements: (1) what must be recorded, and (2) what stop condition must be evaluated.</p>
<ol>
<li><strong>Intent</strong>: state the task class and the success condition.</li>
<li>Must record: intent string.</li>
<li>Must record: success criteria (e.g., “repro no longer fails”).</li>
<li>
<p>Stop condition: if success criteria are ambiguous, stop and request clarification.</p>
</li>
<li>
<p><strong>Plan</strong>: enumerate the next 1–3 actions only, each tied to a gate and a budget slice.</p>
</li>
<li>Must record: planned steps.</li>
<li>Must record: named gates.</li>
<li>Must record: allocated budget slice.</li>
<li>
<p>Stop condition: if the plan requires tools/paths outside permissions, stop and request escalation.</p>
</li>
<li>
<p><strong>Act</strong>: perform the minimal change that tests the current hypothesis.</p>
</li>
<li>Must record: files touched.</li>
<li>Must record: diff stats (and any migration steps taken).</li>
<li>
<p>Stop condition: if diff budget or file-touch budget is exceeded, stop and escalate.</p>
</li>
<li>
<p><strong>Verify</strong>: run the smallest evaluation that is credible for the task class.</p>
</li>
<li>Must record: exact command(s).</li>
<li>Must record: exit codes.</li>
<li>Must record: summary lines (or pointers/hashes to full logs).</li>
<li>Stop condition: if a gate fails, iterate.</li>
<li>Stop condition: if no credible gate exists, stop and escalate.</li>
<li>Gate waivers are acceptable only when the trace records:<ul>
<li>why the gate is not runnable</li>
<li>what alternative check was run</li>
<li>what risk remains</li>
<li>the waiver decision and its rationale</li>
</ul>
</li>
<li>
<p>A waiver is not a “pass”; it is a recorded exception.</p>
</li>
<li>
<p><strong>Record trace</strong>: persist replayable evidence for what happened and why.</p>
</li>
<li>Must record: commands executed.</li>
<li>Must record: outputs (or pointers).</li>
<li>Must record: budgets consumed.</li>
<li>Must record: permissions exercised.</li>
<li>
<p>Stop condition: if persistence fails (cannot write trace), stop; do not continue “blind.”</p>
</li>
<li>
<p><strong>Stop/iterate</strong>: decide based on evidence and remaining budget.</p>
</li>
<li>Must record: decision.</li>
<li>Must record: rationale.</li>
<li>Must record: the next action (either “done” or “what to try next”).</li>
<li>Stop condition: stop on success.</li>
<li>Stop condition: stop when a budget is exhausted.</li>
<li>Stop condition: stop when permissions/scope are insufficient.</li>
</ol>
<p>A diagram is useful here because the kernel has a fixed stage order, while budgets, permissions, and gates constrain stages from the side.
Read solid arrows as the stage sequence. Read dotted arrows as constraints and required checks.
Takeaway: “done” is a verification outcome, and trace artifacts are explicit outputs.</p>
<p>Mermaid mapping of stages to controls and outputs.</p>
<div class="mermaid">flowchart LR
  I[Intent] --&gt; P[Plan] --&gt; A[Act] --&gt; V[Verify] --&gt; R[Record trace] --&gt; S{Stop / iterate}

  B[(Budgets\niterations/time/tool calls/diff size)] -. constrains .-&gt; P
  B -. constrains .-&gt; A
  B -. constrains .-&gt; V
  Perm[(Permissions\nread/write scopes\nprotected paths\nallowed tools)] -. constrains .-&gt; A
  Gate[(Evaluation gates\nby action class)] -. required .-&gt; V
  Persist[(Persistence\nledger/trace logs/artifacts)] -. produced .-&gt; R

  V --&gt;|pass| S
  V --&gt;|fail| P
  S --&gt;|iterate| P
  S --&gt;|stop| End[Exit with summary]
</div>
<p>How to read this diagram:</p>
<ul>
<li>Solid arrows show execution order; dotted arrows show constraints and required checks.</li>
<li><strong>Verify</strong> is where gates produce pass/fail evidence that drives stop vs iterate.</li>
<li><strong>Record trace</strong> produces the artifacts you need to replay what happened.</li>
</ul>
<p>A compact “must capture” checklist (minimum viable trace).</p>
<p>This checklist is the smallest set of fields that enables replay, audit, and debugging without relying on memory or “it seemed fine.”</p>
<table>
<thead>
<tr>
<th>Loop stage</th>
<th>Budget signal</th>
<th>Permission signal</th>
<th>Verification signal</th>
<th>Persistence artifact</th>
</tr>
</thead>
<tbody>
<tr>
<td>intent</td>
<td>remaining iterations/time</td>
<td>required read scope</td>
<td>success criteria defined</td>
<td>intent string + criteria</td>
</tr>
<tr>
<td>plan</td>
<td>tool-call budget allocation</td>
<td>allowed tools list</td>
<td>planned gates named</td>
<td>plan steps + gate mapping</td>
</tr>
<tr>
<td>act</td>
<td>diff size consumed</td>
<td>write scope used</td>
<td>N/A</td>
<td>patch/diff stats</td>
</tr>
<tr>
<td>verify</td>
<td>time/tool calls consumed</td>
<td>execution permissions</td>
<td>gate results (pass/fail)</td>
<td>command + exit code + excerpt</td>
</tr>
<tr>
<td>record trace</td>
<td>N/A</td>
<td>N/A</td>
<td>N/A</td>
<td>ledger entry + trace pointer</td>
</tr>
<tr>
<td>stop/iterate</td>
<td>budget exhausted?</td>
<td>permission insufficient?</td>
<td>gates satisfied?</td>
<td>final summary + next action</td>
</tr>
</tbody>
</table>
<h2 id="concrete-example-1">Concrete Example 1</h2>
<p>Bug-fix kernel for a CLI tool.</p>
<ul>
<li>Input:</li>
<li>failing test case: <code>tests/test_parse.py::test_rejects_empty_input</code></li>
<li>repro command: <code>python -m mycli parse ""</code></li>
<li>observed: exit code <code>0</code></li>
<li>expected: non-zero exit code</li>
<li>budgets:<ul>
<li>max 3 iterations</li>
<li>max 10 tool calls</li>
<li>max 40 lines changed</li>
</ul>
</li>
<li>permissions:<ul>
<li>read: <code>src/</code></li>
<li>write: <code>src/parser.py</code></li>
<li>run: <code>pytest -k parse</code></li>
</ul>
</li>
</ul>
<p>Mini-runbook (a single bounded kernel run):</p>
<ol>
<li>Localize failure (evidence-first)</li>
<li>Action: reproduce with the smallest credible check.<ul>
<li>Command: <code>pytest -k rejects_empty_input</code></li>
</ul>
</li>
<li>Gate: the reproduction must fail in a controlled way.</li>
<li>Gate: the failure should match the same assertion and code path.</li>
<li>Record:<ul>
<li>command: <code>pytest -k rejects_empty_input</code></li>
<li>exit code: <code>1</code></li>
<li>failing excerpt (example):</li>
<li><code>&gt;       assert parse("") != 0</code></li>
<li><code>E       AssertionError: assert 0 != 0</code></li>
<li>test summary line (example): <code>1 failed, 42 deselected in 0.31s</code></li>
</ul>
</li>
<li>
<p>Stop rule: if the failure does not reproduce, stop and return a “cannot reproduce” trace (no edits).</p>
</li>
<li>
<p>Patch minimal surface (hypothesis-driven)</p>
</li>
<li>Action: implement the smallest boundary check consistent with the hypothesis.</li>
<li>Hypothesis: empty string is being treated as a valid token stream in <code>src/parser.py</code>.</li>
<li>Change: reject empty input at the parse entrypoint.</li>
<li>Change: avoid touching downstream call sites.</li>
<li>Gate: stay within 40 changed lines.</li>
<li>Gate: touch only <code>src/parser.py</code> (unless escalation is explicitly allowed).</li>
<li>Record:<ul>
<li>files touched: <code>src/parser.py</code></li>
<li>diff stats (example): <code>src/parser.py | 7 ++++++-</code></li>
</ul>
</li>
<li>
<p>Stop rule: if a second file is required, stop and escalate (“write scope too narrow”).</p>
</li>
<li>
<p>Run verification gate (tight but credible)</p>
</li>
<li>Action: rerun the failing test.<ul>
<li>Command: <code>pytest -k rejects_empty_input</code></li>
<li>Expected summary (example): <code>1 passed, 42 deselected in 0.28s</code></li>
</ul>
</li>
<li>Action: run a small related slice.<ul>
<li>Command: <code>pytest -k parse</code></li>
<li>Expected summary (example): <code>12 passed, 0 failed, 31 deselected in 1.07s</code></li>
</ul>
</li>
<li>Record:<ul>
<li>command 1: <code>pytest -k rejects_empty_input</code></li>
<li>exit code 1: <code>0</code></li>
<li>summary 1 (example): <code>1 passed, 42 deselected in 0.28s</code></li>
<li>command 2: <code>pytest -k parse</code></li>
<li>exit code 2: <code>0</code></li>
<li>summary 2 (example): <code>12 passed, 0 failed, 31 deselected in 1.07s</code></li>
</ul>
</li>
<li>
<p>Stop rule: if Gate 1 passes but Gate 2 fails, treat as “not fixed” and iterate (the patch likely broke a nearby invariant).</p>
</li>
<li>
<p>Record trace (auditable, replayable)</p>
</li>
<li>Action: persist a kernel trace and a ledger entry.</li>
<li>Record (minimum):<ul>
<li>budgets consumed: <code>iterations=1/3</code></li>
<li>budgets consumed: <code>tool_calls=3/10</code></li>
<li>budgets consumed: <code>diff_lines=7/40</code></li>
<li>commands executed + exit codes</li>
<li>final test summary lines:</li>
<li><code>12 passed, 0 failed, 31 deselected in 1.07s</code></li>
</ul>
</li>
<li>
<p>Stop rule: if trace persistence fails, stop; do not continue with further edits.</p>
</li>
<li>
<p>Stop criteria (explicit)</p>
</li>
<li>Stop success: Gate 1 and Gate 2 pass within budget.</li>
<li>Stop failure: tool-call budget exhausted.</li>
<li>Stop failure: diff budget exceeded.</li>
<li>Stop failure: verification indicates a broader refactor is required.</li>
<li>Stop escalation output: include the next action for a human.<ul>
<li>Example: “tokenization treats whitespace-only as empty.”</li>
<li>Example: “requires editing <code>src/lexer.py</code>, outside current write scope.”</li>
</ul>
</li>
</ol>
<p>This stays stable and debuggable because the kernel cannot declare success without passing named gates, and each iteration is bounded by explicit budgets.</p>
<h2 id="concrete-example-2">Concrete Example 2</h2>
<p>Dependency upgrade kernel.</p>
<ul>
<li>Input:</li>
<li>target version: <code>libX 4.2.0 → 4.3.0</code></li>
<li>constraints:<ul>
<li>Python <code>&gt;=3.10</code></li>
<li>cannot change public API</li>
<li>CI must stay green</li>
</ul>
</li>
<li>upgrade guide note:<ul>
<li>breaking rename <code>OldClient</code> → <code>Client</code></li>
</ul>
</li>
<li>budgets:<ul>
<li>max 4 iterations</li>
<li>max 15 tool calls</li>
<li>max 120 lines changed</li>
</ul>
</li>
<li>permissions:<ul>
<li>write: <code>pyproject.toml</code></li>
<li>write: <code>src/</code></li>
<li>run: <code>python -m compileall</code></li>
<li>run: <code>pytest</code></li>
</ul>
</li>
</ul>
<p>Kernel steps with an explicit remediation branch:</p>
<ol>
<li>Update manifest (narrow scope)</li>
<li>Action: bump version constraint in <code>pyproject.toml</code>.</li>
<li>Record:<ul>
<li>old constraint (example): <code>libX&gt;=4.2,&lt;4.3</code></li>
<li>new constraint (example): <code>libX&gt;=4.3,&lt;4.4</code></li>
<li>diff stats for manifest only (example): <code>pyproject.toml | 1 +-</code></li>
</ul>
</li>
<li>
<p>Stop/iterate rule:</p>
<ul>
<li>If the dependency resolver cannot produce a consistent lock, stop with resolver output.</li>
<li>Do not attempt ad-hoc pinning unless that is explicitly in scope.</li>
</ul>
</li>
<li>
<p>Run a fast build/type gate before full tests</p>
</li>
<li>Gate A (fast): import/type/compile smoke check.<ul>
<li>Command: <code>python -m compileall src</code></li>
</ul>
</li>
<li>Record:<ul>
<li>exit code</li>
<li>compile summary lines (example):</li>
<li><code>Listing 'src'...</code></li>
<li><code>Compiling 'src/app.py'...</code></li>
<li><code>compileall: success</code></li>
</ul>
</li>
<li>
<p>Interpretation:</p>
<ul>
<li>If Gate A fails, it is often a missing symbol or incompatible API.</li>
<li>Remediate before running the full suite.</li>
</ul>
</li>
<li>
<p>Remediation branch (compile errors vs failing tests)</p>
</li>
<li>
<p>If <strong>compile/import fails</strong>:</p>
<ul>
<li>Localize:</li>
<li>Capture the first error site (file + symbol) from the compile output.</li>
<li>Example line: <code>***   File "src/integrations/libx.py", line 12</code></li>
<li>Example line: <code>ImportError: cannot import name 'OldClient' from 'libx'</code></li>
<li>Patch:</li>
<li>Apply the minimal mechanical fix in the smallest set of files.</li>
<li>Example: rename <code>OldClient</code> to <code>Client</code>.</li>
<li>Verify:</li>
<li>Rerun Gate A only.</li>
<li>Proceed only when it returns exit code <code>0</code>.</li>
<li>Budget guard:</li>
<li>If more than 5 files are touched, stop and escalate (“requires broader refactor”).</li>
<li>If cumulative diff exceeds 120 lines, stop and escalate (“exceeds change budget for this kernel”).</li>
</ul>
</li>
<li>
<p>If <strong>compile passes but tests fail</strong>:</p>
<ul>
<li>Localize:</li>
<li>Run the smallest failing unit (single file or single test) based on the first failure.</li>
<li>Example command: <code>pytest tests/test_libx_integration.py -q</code></li>
<li>Example summary: <code>1 failed, 18 passed in 4.92s</code></li>
<li>Patch:</li>
<li>Address the behavioral change with a targeted adjustment.</li>
<li>Record the reason.</li>
<li>Example: “libX now defaults timeout=None; set explicit timeout=5.0 in wrapper”.</li>
<li>Verify:</li>
<li>Rerun the failing tests.</li>
<li>Proceed to the full suite gate only after the localized failure is cleared.</li>
</ul>
</li>
<li>
<p>Run full verification gate (credibility gate)</p>
</li>
<li>Gate B (full): run the test suite (or the project’s standard verification command).<ul>
<li>Command: <code>pytest</code></li>
</ul>
</li>
<li>Record:<ul>
<li>exit code</li>
<li>test summary line (example): <code>219 passed, 0 failed in 38.41s</code></li>
</ul>
</li>
<li>
<p>Verification risk handling:</p>
<ul>
<li>A narrowed verification set is acceptable only as an explicit gate waiver.</li>
<li>Record why the full gate is unavailable.</li>
<li>Record what alternative gate was run.</li>
<li>Record what risk remains.</li>
<li>Do not label a waiver as “green”; label it as “waived.”</li>
</ul>
</li>
<li>
<p>Stop criteria and outputs</p>
</li>
<li>Stop success: Gate A and Gate B pass within budget.</li>
<li>Stop failure: repeated failures indicate the upgrade exceeds current permission/scope (e.g., requires API redesign), or budgets are exhausted.</li>
<li>Required outputs on stop:<ul>
<li>change summary:</li>
<li>files touched</li>
<li>primary reason</li>
<li>verification summary:</li>
<li>Gate A command + result (include summary lines)</li>
<li>Gate B command + result (include summary lines)</li>
<li>rollback plan:</li>
<li>“revert manifest bump and lockfile” (or equivalent)</li>
<li>exact files to revert</li>
</ul>
</li>
</ol>
<p>This avoids “fix-forward” drift by forcing an early gate (compile) to localize breakage, and by stopping when remediation expands beyond the change budget.</p>
<h2 id="trade-offs">Trade-offs</h2>
<ul>
<li>
<p>Smaller kernels reduce risk but may require orchestration for multi-step projects.</p>
</li>
<li>
<p>Mitigation: use staged kernels (e.g., “diagnose-only” kernel → “patch” kernel → “refactor” kernel), each with separate budgets and permissions.</p>
</li>
<li>
<p>Strict permissions reduce blast radius but can prevent necessary refactors.</p>
</li>
<li>
<p>Mitigation: use permission escalation as an explicit step with a justification and a widened verification gate (e.g., requiring a broader test suite when write scope expands).</p>
</li>
<li>
<p>Heavier tracing improves auditability but adds operational overhead.</p>
</li>
<li>
<p>Mitigation: record a minimum viable trace by default (commands, diffs, gate results), and sample/expand traces only on failures or high-risk task classes.</p>
</li>
</ul>
<h2 id="failure-modes">Failure Modes</h2>
<ul>
<li><strong>Local minima</strong>: kernel makes safe micro-edits without addressing root cause.</li>
<li><strong>Tool thrash</strong>: too many actions with low information gain.</li>
<li><strong>False confidence</strong>: passing a narrow eval set while violating higher-level requirements.</li>
</ul>
<p>Detection signals should be tied to budgets and evaluation gates, not intuition.</p>
<table>
<thead>
<tr>
<th>Failure mode</th>
<th>Detection signals (operational)</th>
</tr>
</thead>
<tbody>
<tr>
<td>Local minima</td>
<td>Same verification failure repeats across iterations.<br/>Edits stay confined to the same small area.<br/>Diff size increases without new localized evidence (no tighter repro, no new failing test isolated).<br/>Iteration budget is consumed with no change in selected gates or outcomes.</td>
</tr>
<tr>
<td>Tool thrash</td>
<td>Tool-call count rises while the plan and hypothesis remain unchanged.<br/>The same command is rerun without an intervening change that could affect its result.<br/>Files touched increases despite a small, bounded intent.</td>
</tr>
<tr>
<td>False confidence</td>
<td>Gates get narrower over time without a recorded waiver and risk note.<br/>Fast gates pass, but the credibility gate is repeatedly deferred without an explicit waiver record.<br/>Success is declared without a trace artifact that includes exact gate commands, exit codes, and summary lines.</td>
</tr>
</tbody>
</table>
<h2 id="research-directions">Research Directions</h2>
<ul>
<li>Kernel composition patterns (delegation, staged permissions, multi-kernel workflows).</li>
<li>Automatic stop-condition tuning based on task class.</li>
<li>Replayable kernels for deterministic debugging of agent behavior.</li>
</ul>
</article>
</div>
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
</div>
</main>
<footer class="md-footer">
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
      Material for MkDocs
    </a>
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<script id="__config" type="application/json">{"annotate": null, "base": "../../..", "features": [], "search": "../../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
<script src="../../../assets/javascripts/bundle.79ae519e.min.js"></script>
<script type="module">import mermaid from "https://unpkg.com/mermaid@10.4.0/dist/mermaid.esm.min.mjs";
mermaid.initialize({});</script></body>
</html>